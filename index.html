<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0a0e27">
    <title>CryptoPhysics Portfolio Analyzer - Tetris Edition</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Mobile Overlay -->
    <div class="mobile-overlay" id="mobileOverlay"></div>

    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle Menu">
        <span></span>
        <span></span>
        <span></span>
    </button>

    <div class="container">
        <!-- SIDEBAR -->
        <aside class="sidebar" id="sidebar">
            <div class="logo">
                <h1>ğŸ® CryptoPhysics</h1>
                <p class="tagline">Portfolio Tetris Visual</p>
                <button class="btn-help" id="howItWorksBtn">â“ Como Funciona?</button>
            </div>

            <!-- FORMULÃRIO DE ADIÃ‡ÃƒO -->
            <div class="control-panel">
                <h2>ğŸ’ Adicionar Ativo</h2>
                <form id="addAssetForm">
                    <div class="form-group">
                        <label for="assetSelect">Criptomoeda</label>
                        <select id="assetSelect" required>
                            <option value="">Selecione...</option>
                            <option value="bitcoin">â‚¿ Bitcoin (BTC)</option>
                            <option value="ethereum">Î Ethereum (ETH)</option>
                            <option value="solana">â— Solana (SOL)</option>
                            <option value="cardano">â‚³ Cardano (ADA)</option>
                            <option value="dogecoin">ğŸ• Dogecoin (DOGE)</option>
                            <option value="shiba-inu">ğŸ• Shiba Inu (SHIB)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="quantityInput">Quantidade</label>
                        <input type="number" id="quantityInput" min="0.001" step="0.001" placeholder="Ex: 0.5" required>
                    </div>

                    <button type="submit" class="btn btn-primary">
                        â• Adicionar ao PortfÃ³lio
                    </button>
                </form>
            </div>

            <!-- MÃ‰TRICAS -->
            <div class="metrics">
                <h2>ğŸ“Š MÃ©tricas da Carteira</h2>
                <div class="metric-item">
                    <span class="metric-label">ğŸ’° Valor Total:</span>
                    <span class="metric-value" id="totalValue">$0.00</span>
                </div>
                <div class="metric-item">
                    <span class="metric-label">ğŸ“ˆ Ativos:</span>
                    <span class="metric-value" id="assetCount">0</span>
                </div>
                <div class="metric-item">
                    <span class="metric-label">ğŸ“ Altura Pilha:</span>
                    <span class="metric-value" id="stackHeight">0</span>
                </div>
                <div class="metric-item">
                    <span class="metric-label">ğŸ¯ Risco:</span>
                    <span class="metric-value risk-indicator" id="riskLevel">Nenhum</span>
                </div>
                <div class="metric-item">
                    <span class="metric-label">ğŸŒˆ DiversificaÃ§Ã£o:</span>
                    <span class="metric-value" id="diversification">0%</span>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="diversificationBar"></div>
                </div>
            </div>

            <!-- AÃ‡Ã•ES -->
            <div class="actions">
                <h2>âš™ï¸ AÃ§Ãµes</h2>
                <button class="btn btn-info" id="reorganizeBtn" title="Reorganiza peÃ§as otimizando espaÃ§o">
                    ğŸ”„ Reorganizar
                </button>
                <button class="btn btn-success" id="saveBtn" title="Salvar no navegador">
                    ğŸ’¾ Salvar Carteira
                </button>
                <button class="btn btn-danger" id="clearBtn" title="Remover todos os ativos">
                    ğŸ—‘ï¸ Limpar Tudo
                </button>
            </div>

            <!-- LEGENDA -->
            <div class="legend">
                <h3>ğŸ“– Legenda das Formas</h3>
                <div class="legend-item">
                    <span class="legend-color" style="background: #F7931A;"></span>
                    <span>BTC = Quadrado 4x4</span>
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background: #627EEA;"></span>
                    <span>ETH = RetÃ¢ngulo 4x3</span>
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background: #14F195;"></span>
                    <span>SOL = L-Shape 3x3</span>
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background: #0033AD;"></span>
                    <span>ADA = T-Shape 3x2</span>
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background: #FF1493;"></span>
                    <span>DOGE/SHIB = Cubinhos 1x1</span>
                </div>
            </div>
        </aside>

        <!-- CANVAS TETRIS -->
        <main class="canvas-container">
            <div class="canvas-header">
                <h2>ğŸ® VisualizaÃ§Ã£o Tetris do PortfÃ³lio</h2>
                <div class="canvas-stats">
                    <span id="blockCount">Blocos: 0</span>
                </div>
            </div>
            <canvas id="tetrisCanvas"></canvas>
            <div class="canvas-info">
                <p>ğŸ’¡ <strong>Dica:</strong> Blocos se encaixam automaticamente! Clique em um bloco para ver detalhes.</p>
            </div>
        </main>
    </div>

    <!-- Modal de Detalhes -->
    <div id="assetModal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2 id="modalTitle"></h2>
            <div id="modalBody"></div>
            <button class="btn btn-danger" id="removeAssetBtn">ğŸ—‘ï¸ Remover Ativo</button>
        </div>
    </div>

    <!-- Modal Como Funciona -->
    <div id="howItWorksModal" class="modal">
        <div class="modal-content modal-large">
            <span class="modal-close" id="closeHowItWorks">&times;</span>
            <h2 class="modal-title-fancy">â“ Como Funciona o CryptoPhysics Tetris?</h2>

            <div class="how-it-works-content">
                <section class="info-section">
                    <h3>ğŸ® O Conceito</h3>
                    <p>No CryptoPhysics Tetris, cada criptomoeda Ã© representada por <strong>blocos coloridos</strong> que se encaixam automaticamente formando um mosaico visual da sua carteira:</p>
                    <ul>
                        <li><strong>Forma</strong> = Tipo de criptomoeda</li>
                        <li><strong>Tamanho</strong> = Quantidade investida</li>
                        <li><strong>Altura da pilha</strong> = DiversificaÃ§Ã£o do portfÃ³lio</li>
                    </ul>
                </section>

                <section class="info-section">
                    <h3>ğŸ¨ Formas dos Ativos</h3>
                    <div class="asset-examples">
                        <div class="asset-card">
                            <span class="asset-icon">ğŸŸ§</span>
                            <h4>Bitcoin (BTC)</h4>
                            <p><strong>Quadrado 4x4:</strong> SÃ³lido e robusto, ocupa espaÃ§o significativo representando estabilidade.</p>
                        </div>
                        <div class="asset-card">
                            <span class="asset-icon">ğŸŸ¦</span>
                            <h4>Ethereum (ETH)</h4>
                            <p><strong>RetÃ¢ngulo 4x3:</strong> Base larga e confiÃ¡vel, ideal para encaixar outros blocos.</p>
                        </div>
                        <div class="asset-card">
                            <span class="asset-icon">ğŸŸ©</span>
                            <h4>Solana (SOL)</h4>
                            <p><strong>L-Shape:</strong> Forma Ã¡gil que preenche cantos e espaÃ§os irregulares.</p>
                        </div>
                        <div class="asset-card">
                            <span class="asset-icon">ğŸ”µ</span>
                            <h4>Cardano (ADA)</h4>
                            <p><strong>T-Shape:</strong> Versatil para preencher gaps no portfÃ³lio.</p>
                        </div>
                        <div class="asset-card">
                            <span class="asset-icon">ğŸŒ¸</span>
                            <h4>Memecoins (DOGE/SHIB)</h4>
                            <p><strong>Cubinhos 1x1:</strong> Pequenos e numerosos, preenchem qualquer espaÃ§o!</p>
                        </div>
                    </div>
                </section>

                <section class="info-section">
                    <h3>ğŸ¯ Como Funciona o Encaixe</h3>
                    <div class="controls-grid">
                        <div class="control-item">
                            <span class="control-emoji">â¬‡ï¸</span>
                            <strong>Queda AutomÃ¡tica:</strong> Ao adicionar, o bloco cai do topo
                        </div>
                        <div class="control-item">
                            <span class="control-emoji">ğŸ§©</span>
                            <strong>Encaixe Perfeito:</strong> Blocos se posicionam sem deixar buracos
                        </div>
                        <div class="control-item">
                            <span class="control-emoji">âœ¨</span>
                            <strong>Efeito Visual:</strong> PartÃ­culas e glow ao encaixar
                        </div>
                        <div class="control-item">
                            <span class="control-emoji">ğŸ”„</span>
                            <strong>Reorganizar:</strong> Otimiza espaÃ§o rearranjando blocos
                        </div>
                        <div class="control-item">
                            <span class="control-emoji">ğŸ‘†</span>
                            <strong>Clique:</strong> Veja detalhes do ativo
                        </div>
                        <div class="control-item">
                            <span class="control-emoji">ğŸ’¾</span>
                            <strong>Salvar:</strong> Preserva sua carteira no navegador
                        </div>
                    </div>
                </section>

                <section class="info-section">
                    <h3>ğŸ“Š Interpretando as MÃ©tricas</h3>
                    <ul>
                        <li><strong>ğŸ’° Valor Total:</strong> Soma do valor de todos os ativos (preÃ§os em tempo real via CoinGecko)</li>
                        <li><strong>ğŸ“ˆ Ativos:</strong> NÃºmero de diferentes criptomoedas no portfÃ³lio</li>
                        <li><strong>ğŸ“ Altura Pilha:</strong> Quantos nÃ­veis de blocos sua carteira possui</li>
                        <li><strong>ğŸ¯ Risco:</strong> Calculado pela volatilidade mÃ©dia ponderada (Baixo &lt;2%, MÃ©dio 2-4%, Alto &gt;4%)</li>
                        <li><strong>ğŸŒˆ DiversificaÃ§Ã£o:</strong> Percentual baseado na variedade de criptos (mÃ¡ximo 6 tipos)</li>
                    </ul>
                </section>

                <section class="info-section tips-section">
                    <h3>ğŸ’¡ Dicas de Uso</h3>
                    <ul class="tips-list">
                        <li>ğŸ¯ Comece com BTC ou ETH para criar uma base sÃ³lida</li>
                        <li>ğŸ”„ Use Reorganizar para visualizar melhor quando tiver muitos blocos</li>
                        <li>ğŸ’¾ Salve sua carteira para nÃ£o perder o progresso</li>
                        <li>ğŸŒˆ Diversifique para criar padrÃµes visuais interessantes</li>
                        <li>ğŸ• Memecoins sÃ£o Ã³timos para preencher pequenos espaÃ§os!</li>
                    </ul>
                </section>
            </div>
        </div>
    </div>

    <!-- Chart.js CDN (opcional para grÃ¡ficos futuros) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- App Principal -->
    <script src="app.js"></script>
</body>
</html>
